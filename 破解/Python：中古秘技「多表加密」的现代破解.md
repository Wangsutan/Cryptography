# Python：中古秘技「多表加密」的现代破解

破解了凯撒密码之后，我就开始思考如何破解更高环节上的「多表加密」。没想到，代码调通之后，竟然一击必杀。现在分享出来我的一些成果。

代码如下：

```

```

明文来自[这里](http://www.catb.org/~esr/faqs/hacker-howto.html)，选取了《Historical Note: Hacking, Open Source, and Free Software》一节的正文，再用我此前设计的「多表加密」算法（见我之前分享出来的[相关资源](https://zhuanlan.zhihu.com/p/399811683)），用关键词`dog`加密。

然后，注意，在破解算法中，变量`step`的值需要破解者自行设置，比如我设置成`3`。从实际情况来看，这个值需要猜。但为方便起见，我直接掩耳盗铃了。

然后开始破解。基本的环节，参考了破解凯撒密码的算法。还需要破解者自行输入`step`个值，要用空格隔开，以确定如何使用高频字母列表。可以先输入`0 0 0`，这表示若干的值都对应最高频的字母。

若所输入的这样的若干值无法算出正确结果，可适当参考已经破解的非完全正确的结果，增大它们的值，比如`1 0 0 `等等，逐个猜测。

与破解凯撒密码时一样，密文越长，越易破解出来。这次，我是一击必杀。

下面是某次运行结果，破解出来的密文是对的：

```
step: 3
charsCounters: [[(7, 133)], [(18, 132)], [(10, 137)]]

Set 3 numbers of decoding:0 0 0
[0, 0, 0]
3
14
6
WHENIORIGINALLYWROTETHISHOWTOINLATESOMEOFTHECONDITIONSAROUNDITWEREVERYDIFFERENTFROMTHEWAYTHEYLOOKTODAYAFEWWORDSABOUTTHESECHANGESMAYHELPCLARIFYMATTERSFORPEOPLEWHOARECONFUSEDABOUTTHERELATIONSHIPOFOPENSOURCEFREESOFTWAREANDLINUXTOTHEHACKERCOMMUNITYIFYOUARENOTCURIOUSABOUTTHISYOUCANSKIPSTRAIGHTTOTHEFAQANDBIBLIOGRAPHYFROMHERETHEHACKERETHOSANDCOMMUNITYASIHAVEDESCRIBEDITHERELONGPREDATESTHEEMERGENCEOFLINUXAFTERIFIRSTBECAMEINVOLVEDWITHITAROUNDANDITSROOTSAREREADILYTRACEABLEBACKTOTHEEARLYSBUTBEFORELINUXMOSTHACKINGWASDONEONEITHERPROPRIETARYOPERATINGSYSTEMSORAHANDFULOFQUASIEXPERIMENTALHOMEGROWNSYSTEMSLIKEMITSITSTHATWERENEVERDEPLOYEDOUTSIDEOFTHEIRORIGINALACADEMICNICHESWHILETHEREHADBEENSOMEEARLIERPRELINUXATTEMPTSTOCHANGETHISSITUATIONTHEIRIMPACTWASATBESTVERYMARGINALANDCONFINEDTOCOMMUNITIESOFDEDICATEDTRUEBELIEVERSWHICHWERETINYMINORITIESEVENWITHINTHEHACKERCOMMUNITYLETALONEWITHRESPECTTOTHELARGERWORLDOFSOFTWAREINGENERALWHATISNOWCALLEDOPENSOURCEGOESBACKASFARASTHEHACKERCOMMUNITYDOESBUTUNTILITWASANUNNAMEDFOLKPRACTICERATHERTHANACONSCIOUSMOVEMENTWITHTHEORIESANDMANIFESTOSATTACHEDTOITTHISPREHISTORYENDEDWHENINARCHHACKERRICHARDSTALLMANRMSTRIEDTOGIVEITANAMEFREESOFTWAREBUTHISACTOFNAMINGWASALSOANACTOFCLAIMINGHEATTACHEDIDEOLOGICALBAGGAGETOTHEFREESOFTWARELABELWHICHMUCHOFTHEEXISTINGHACKERCOMMUNITYNEVERACCEPTEDASARESULTTHEFREESOFTWARELABELWASLOUDLYREJECTEDBYASUBSTANTIALMINORITYOFTHEHACKERCOMMUNITYESPECIALLYAMONGTHOSEASSOCIATEDWITHBSDUNIXANDUSEDWITHSERIOUSBUTSILENTRESERVATIONSBYAMAJORITYOFTHEREMAINDERINCLUDINGMYSELFDESPITETHESERESERVATIONSRMSSCLAIMTODEFINEANDLEADTHEHACKERCOMMUNITYUNDERTHEFREESOFTWAREBANNERBROADLYHELDUNTILTHEMIDSITWASSERIOUSLYCHALLENGEDONLYBYTHERISEOFLINUXLINUXGAVEOPENSOURCEDEVELOPMENTANATURALHOMEMANYPROJECTSISSUEDUNDERTERMSWEWOULDNOWCALLOPENSOURCEMIGRATEDFROMPROPRIETARYUNIXESTOLINUXTHECOMMUNITYAROUNDLINUXGREWEXPLOSIVELYBECOMINGFARLARGERANDMOREHETEROGENOUSTHANTHEPRELINUXHACKERCULTURERMSDETERMINEDLYATTEMPTEDTOCOOPTALLTHISACTIVITYINTOHISFREESOFTWAREMOVEMENTBUTWASTHWARTEDBYBOTHTHEEXPLODINGDIVERSITYOFTHELINUXCOMMUNITYANDTHEPUBLICSKEPTICISMOFITSFOUNDERLINUSTORVALDSTORVALDSCONTINUEDTOUSETHETERMFREESOFTWAREFORLACKOFANYALTERNATIVEBUTPUBLICLYREJECTEDRMSSIDEOLOGICALBAGGAGEMANYYOUNGERHACKERSFOLLOWEDSUITINWHENIFIRSTPUBLISHEDTHISHACKERHOWTOTHEHACKERCOMMUNITYWASRAPIDLYREORGANIZINGAROUNDLINUXANDAHANDFULOFOTHEROPENSOURCEOPERATINGSYSTEMSNOTABLYTHOSEDESCENDEDFROMBSDUNIXCOMMUNITYMEMORYOFTHEFACTTHATMOSTOFUSHADSPENTDECADESDEVELOPINGCLOSEDSOURCESOFTWAREONCLOSEDSOURCEOPERATINGSYSTEMSHADNOTYETBEGUNTOFADEBUTTHATFACTWASALREADYBEGINNINGTOSEEMLIKEPARTOFADEADPASTHACKERSWEREINCREASINGLYDEFININGTHEMSELVESASHACKERSBYTHEIRATTACHMENTSTOOPENSOURCEPROJECTSSUCHASLINUXORAPACHETHETERMOPENSOURCEHOWEVERHADNOTYETEMERGEDITWOULDNOTDOSOUNTILEARLYWHENITDIDMOSTOFTHEHACKERCOMMUNITYADOPTEDITWITHINTHEFOLLOWINGSIXMONTHSTHEEXCEPTIONSWEREAMINORITYIDEOLOGICALLYATTACHEDTOTHETERMFREESOFTWARESINCEANDESPECIALLYAFTERABOUTTHEIDENTIFICATIONOFHACKINGWITHOPENSOURCEANDFREESOFTWAREDEVELOPMENTHASBECOMEEXTREMELYCLOSETODAYTHEREISLITTLEPOINTINATTEMPTINGTODISTINGUISHBETWEENTHESECATEGORIESANDITSEEMSUNLIKELYTHATWILLCHANGEINTHEFUTUREITISWORTHREMEMBERINGHOWEVERTHATTHISWASNOTALWAYSSO

Set 3 numbers of decoding:
```

现在先将这个初稿共享出来，我后续再优化吧，比如：步数的自动猜测，高频词的自动填入，等等。

其他更高级的功能，现在完全谈不上的。